<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>chatKev - Assistant Intelligent</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <style>
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        @keyframes slideInRight {
            from { opacity: 0; transform: translateX(20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .animate-fade { animation: fadeIn 0.4s ease-out; }
        .animate-slide-left { animation: slideIn 0.4s ease-out; }
        .animate-slide-right { animation: slideInRight 0.4s ease-out; }
        .animate-pulse-slow { animation: pulse 1.5s ease-in-out infinite; }
        
        .gradient-bg {
            background: linear-gradient(-45deg, #667eea, #764ba2, #f093fb, #4facfe);
            background-size: 400% 400%;
            animation: gradient 15s ease infinite;
        }
        
        #chat::-webkit-scrollbar { width: 8px; }
        #chat::-webkit-scrollbar-thumb { 
            background: linear-gradient(180deg, #667eea, #764ba2);
            border-radius: 10px; 
        }
        #chat::-webkit-scrollbar-track { background: #f1f5f9; }
        
        .message-bubble {
            backdrop-filter: blur(10px);
            transition: transform 0.2s ease;
        }
        
        .message-bubble:hover {
            transform: translateY(-2px);
        }
        
        .typing-indicator span {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #667eea;
            margin: 0 2px;
            animation: pulse 1.4s ease-in-out infinite;
        }
        
        .typing-indicator span:nth-child(2) { animation-delay: 0.2s; }
        .typing-indicator span:nth-child(3) { animation-delay: 0.4s; }
        
        .input-container {
            transition: all 0.3s ease;
        }
        
        .input-container:focus-within {
            transform: translateY(-2px);
            box-shadow: 0 20px 25px -5px rgba(102, 126, 234, 0.1), 0 10px 10px -5px rgba(102, 126, 234, 0.04);
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
    </style>
</head>

<body class="bg-gradient-to-br from-slate-50 via-purple-50 to-blue-50 text-slate-900 h-screen flex flex-col font-sans overflow-hidden">
    
    <!-- Header avec effet gradient -->
    <header class="glass-effect shadow-lg shrink-0 relative overflow-hidden">
        <div class="absolute inset-0 gradient-bg opacity-10"></div>
        <div class="relative px-4 py-2 flex items-center gap-3">
            <div class="bg-gradient-to-br from-indigo-600 to-purple-600 p-2 rounded-lg text-white shadow-lg transform hover:scale-110 transition-transform">
                <i class="fas fa-graduation-cap text-lg"></i>
            </div>
            <div class="flex-1">
                <h1 class="font-bold text-lg bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent">chatKev</h1>
                <p class="text-[10px] text-slate-500">Assistant intelligent IA</p>
            </div>
            <div class="hidden sm:flex items-center gap-1.5 px-2.5 py-1 bg-green-100 text-green-700 rounded-full text-[10px] font-medium">
                <div class="w-1.5 h-1.5 bg-green-500 rounded-full animate-pulse-slow"></div>
                En ligne
            </div>
        </div>
    </header>

    <main class="flex-1 max-w-5xl w-full mx-auto px-3 py-2 sm:px-4 sm:py-3 flex flex-col min-h-0">
        
        <!-- Zone de chat avec effet de profondeur -->
        <div id="chat" class="flex-1 space-y-3 mb-2 p-3 sm:p-4 rounded-3xl overflow-y-auto glass-effect shadow-2xl relative">
            <!-- Message de bienvenue -->
            <div class="flex gap-3 animate-slide-left">
                <div class="w-10 h-10 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white shrink-0 shadow-lg">
                    <i class="fas fa-robot"></i>
                </div>
                <div class="message-bubble bg-white p-4 rounded-2xl rounded-tl-none shadow-lg text-base max-w-[85%] border border-slate-100">
                    <p class="text-slate-700 leading-relaxed">
                        üëã <strong>Bonjour !</strong> Je suis <span class="font-semibold text-indigo-600">chatKev</span>, votre assistant intelligent.
                    </p>
                    <p class="text-slate-600 mt-2">Comment puis-je vous aider aujourd'hui ?</p>
                </div>
            </div>
        </div>

        <!-- Zone de saisie modernis√©e -->
        <div class="input-container glass-effect rounded-2xl shadow-xl p-2 flex gap-2 shrink-0">
            <input 
                id="userInput" 
                type="text" 
                placeholder="Posez votre question..." 
                class="flex-1 p-3 outline-none text-sm bg-transparent placeholder:text-slate-400" 
                onkeypress="if(event.key === 'Enter') sendMessage()"
            >
            <button 
                onclick="sendMessage()" 
                class="bg-gradient-to-r from-indigo-600 to-purple-600 text-white w-12 h-12 rounded-xl hover:from-indigo-700 hover:to-purple-700 transition-all transform hover:scale-105 active:scale-95 shadow-lg"
            >
                <i class="fas fa-paper-plane"></i>
            </button>
        </div>

        <!-- Suggestions rapides (optionnel) -->
        <div class="flex gap-2 mt-2 overflow-x-auto pb-1">
            <button onclick="quickQuestion('Explique-moi la photosynth√®se')" class="px-4 py-2 bg-white/60 hover:bg-white rounded-full text-xs whitespace-nowrap transition-all shadow-sm hover:shadow-md">
                <i class="fas fa-leaf text-green-500 mr-1"></i> Photosynth√®se
            </button>
            <button onclick="quickQuestion('Comment fonctionne Internet ?')" class="px-4 py-2 bg-white/60 hover:bg-white rounded-full text-xs whitespace-nowrap transition-all shadow-sm hover:shadow-md">
                <i class="fas fa-wifi text-blue-500 mr-1"></i> Internet
            </button>
            <button onclick="quickQuestion('Raconte-moi une blague')" class="px-4 py-2 bg-white/60 hover:bg-white rounded-full text-xs whitespace-nowrap transition-all shadow-sm hover:shadow-md">
                <i class="fas fa-smile text-yellow-500 mr-1"></i> Blague
            </button>
        </div>
    </main>

    <script>
// ‚ö†Ô∏è ATTENTION : Ne jamais exposer de cl√© API dans le code frontend !
// Ceci est un exemple - utilisez un backend pour s√©curiser vos cl√©s
const API_KEY = "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";
const MODEL = "meta-llama/llama-3-8b-instruct";

let messages = [{ role: "system", content: "Tu es un tuteur p√©dagogique sympathique et patient. R√©ponds de mani√®re claire et encourageante." }];
let isTyping = false;

// Fonction d'envoi de message
async function sendMessage() {
    const input = document.getElementById("userInput");
    const userMsg = input.value.trim();
    
    if (!userMsg || isTyping) return;

    // Afficher le message utilisateur
    renderMsg('user', userMsg);
    messages.push({ role: "user", content: userMsg });
    input.value = "";

    // Afficher l'indicateur de saisie
    showTypingIndicator();
    isTyping = true;

    try {
        const response = await fetch("https://openrouter.ai/api/v1/chat/completions", {
            method: "POST",
            headers: { 
                "Authorization": `Bearer ${API_KEY}`, 
                "Content-Type": "application/json" 
            },
            body: JSON.stringify({ 
                model: MODEL, 
                messages: messages 
            })
        });
        
        const data = await response.json();
        
        // V√©rification de la r√©ponse
        if (!data.choices || !data.choices[0]) {
            throw new Error("R√©ponse invalide de l'API");
        }
        
        const aiReply = data.choices[0].message.content;
        
        // Simulation d'un d√©lai pour plus de naturel
        await new Promise(resolve => setTimeout(resolve, 800));
        
        removeTypingIndicator();
        messages.push({ role: "assistant", content: aiReply });
        renderMsg('assistant', aiReply);

    } catch (error) {
        console.error("Erreur API:", error);
        removeTypingIndicator();
        renderMsg('assistant', "‚ö†Ô∏è D√©sol√©, je rencontre un probl√®me technique. Veuillez r√©essayer dans quelques instants.");
    } finally {
        isTyping = false;
    }
}

// Affichage des messages
function renderMsg(role, text) {
    const chat = document.getElementById("chat");
    const isAI = role === 'assistant';
    
    const msgDiv = document.createElement("div");
    msgDiv.className = `flex gap-3 ${isAI ? 'animate-slide-left' : 'flex-row-reverse animate-slide-right'}`;
    
    const avatar = isAI 
        ? '<div class="w-10 h-10 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white shrink-0 shadow-lg"><i class="fas fa-robot"></i></div>'
        : '<div class="w-10 h-10 rounded-full bg-gradient-to-br from-slate-700 to-slate-900 flex items-center justify-center text-white shrink-0 shadow-lg"><i class="fas fa-user"></i></div>';
    
    const bubbleClass = isAI 
        ? 'message-bubble bg-white border border-slate-100 rounded-tl-none' 
        : 'message-bubble bg-gradient-to-br from-indigo-600 to-purple-600 text-white rounded-tr-none';
    
    msgDiv.innerHTML = `
        ${avatar}
        <div class="${bubbleClass} p-4 rounded-2xl shadow-lg max-w-[85%] text-base">
            <div class="whitespace-pre-wrap leading-relaxed">${escapeHtml(text)}</div>
        </div>
    `;

    chat.appendChild(msgDiv);
    msgDiv.scrollIntoView({ behavior: 'smooth', block: 'end' });
}

// Indicateur de saisie
function showTypingIndicator() {
    const chat = document.getElementById("chat");
    const typingDiv = document.createElement("div");
    typingDiv.id = "typing-indicator";
    typingDiv.className = "flex gap-3 animate-slide-left";
    typingDiv.innerHTML = `
        <div class="w-10 h-10 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white shrink-0 shadow-lg">
            <i class="fas fa-robot"></i>
        </div>
        <div class="bg-white border border-slate-100 p-4 rounded-2xl rounded-tl-none shadow-lg">
            <div class="typing-indicator flex items-center gap-1">
                <span></span><span></span><span></span>
            </div>
        </div>
    `;
    chat.appendChild(typingDiv);
    typingDiv.scrollIntoView({ behavior: 'smooth', block: 'end' });
}

function removeTypingIndicator() {
    const indicator = document.getElementById("typing-indicator");
    if (indicator) indicator.remove();
}

// Questions rapides
function quickQuestion(question) {
    document.getElementById("userInput").value = question;
    sendMessage();
}

// S√©curit√© : √©chapper le HTML
function escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
}

// Focus automatique sur l'input
document.getElementById("userInput").focus();
    </script>
</body>
</html>